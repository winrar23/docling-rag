# docling-rag

CLI-—É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏. –ü–∞—Ä—Å–∏—Ç PDF, DOCX, Markdown –∏ TXT, –Ω–∞—Ä–µ–∑–∞–µ—Ç –Ω–∞ chunks, —Å—Ç—Ä–æ–∏—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –±–ª–∏–∂–∞–π—à–∏–º–∏ –ø–æ —Å–º—ã—Å–ª—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏.

> **MVP:** –ø–æ–∏—Å–∫ –±–µ–∑ LLM-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—ã—Ä—ã–µ chunks —Å cosine similarity score.

---

## –ó–∞—á–µ–º

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ PDF, DOCX –∏ Confluence ‚Äî —Å–ª–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å
- –û–±—ã—á–Ω—ã–π `grep` –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Å–º—ã—Å–ª–æ–≤—ã–µ —Å–∏–Ω–æ–Ω–∏–º—ã
- –ù—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –ø–æ–¥–ø–∏—Å–æ–∫

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
git clone https://github.com/winrar23/docling-rag.git
cd docling-rag
uv pip install -e .

# 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
docling-rag init

# 3. –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã (—Ñ–∞–π–ª –∏–ª–∏ –ø–∞–ø–∫—É)
docling-rag add ./docs/

# 4. –ü–æ–∏—Å–∫
docling-rag search "—Å—Ö–µ–º–∞ –∑–≤–µ–∑–¥–∞ –∏ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤"

# 5. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ
docling-rag list
```

–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ —Å–∫–∞—á–∞–µ—Ç –º–æ–¥–µ–ª—å `all-MiniLM-L6-v2` (~90 –ú–ë) –∏ –∑–∞–∫—ç—à–∏—Ä—É–µ—Ç –µ—ë –ª–æ–∫–∞–ª—å–Ω–æ.

---

## –ö–æ–º–∞–Ω–¥—ã

### `init` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

```bash
docling-rag init [--data-dir data] [--config config.yaml]
```

–°–æ–∑–¥–∞—ë—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –ø–∞–ø–∫—É –¥–ª—è –ª–æ–≥–æ–≤. –ë–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ.

---

### `add` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –∏–Ω–¥–µ–∫—Å

```bash
docling-rag add <–ø—É—Ç—å> [--data-dir data] [--config config.yaml]
```

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª –∏–ª–∏ –ø–∞–ø–∫—É. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: **PDF, DOCX, MD, TXT**.

- –¢–∞–±–ª–∏—Ü—ã –∏ code-–±–ª–æ–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –Ω–µ–¥–µ–ª–∏–º—ã–µ chunks
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ñ–∞–π–ª–µ ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç

```bash
# –ü—Ä–∏–º–µ—Ä—ã
docling-rag add architecture.pdf
docling-rag add ./docs/
docling-rag add report.docx --data-dir /var/myproject/store
```

---

### `search` ‚Äî —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫

```bash
docling-rag search "<–∑–∞–ø—Ä–æ—Å>" [--top-k 5] [--data-dir data] [--config config.yaml]
```

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ø-K —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ cosine similarity. –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å–º—ã—Å–ª—É, –∞ –Ω–µ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º.

```bash
# –ü—Ä–∏–º–µ—Ä—ã
docling-rag search "–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"
docling-rag search "ETL pipeline best practices" --top-k 10
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**

```
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è: "—Å—Ö–µ–º–∞ –∑–≤–µ–∑–¥–∞ –∏ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤"
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

[1] score=0.720 | architecture.md | —Å—Ç—Ä.1 | text
    DWH –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ö–µ–º—É –∑–≤–µ–∑–¥–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π...

[2] score=0.651 | design.pdf | —Å—Ç—Ä.4 | text
    Fact table —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏: –ø—Ä–æ–¥–∞–∂–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ...
```

---

### `list` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```bash
docling-rag list [--data-dir data]
```

```
–ü—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: 3
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  architecture.md                          4 chunks  (docs/architecture.md)
  design.pdf                              12 chunks  (docs/design.pdf)
  etl_pipeline.docx                        7 chunks  (docs/etl_pipeline.docx)
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —á–∏—Ç–∞–µ—Ç—Å—è `config.yaml` –∏–∑ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

```yaml
embedding_model: all-MiniLM-L6-v2   # –º–æ–¥–µ–ª—å –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
chunk_size: 3200                     # —Ä–∞–∑–º–µ—Ä chunk –≤ —Å–∏–º–≤–æ–ª–∞—Ö (‚âà800 —Ç–æ–∫–µ–Ω–æ–≤)
chunk_overlap: 320                   # overlap –º–µ–∂–¥—É chunks (10%)
top_k_results: 5                     # —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
data_dir: data                       # –ø–∞–ø–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
log_file: logs/search.log            # –ª–æ–≥ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

–ü—É—Ç—å –∫ –∫–æ–Ω—Ñ–∏–≥—É –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ–ª–∞–≥–æ–º `--config`:

```bash
docling-rag add ./docs/ --config /etc/myproject/config.yaml
```

> **–í–∞–∂–Ω–æ:** –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å `embedding_model` –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç—ã —É–∂–µ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤ –∏–∑–º–µ–Ω–∏—Ç—Å—è. –î–ª—è —Å–º–µ–Ω—ã –º–æ–¥–µ–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –∑–∞–Ω–æ–≤–æ.

---

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

| –§–æ—Ä–º–∞—Ç | –ü–∞—Ä—Å–∏–Ω–≥ | –¢–∞–±–ª–∏—Ü—ã | –ö–æ–¥ |
|--------|---------|---------|-----|
| PDF    | Docling | ‚úì | ‚úì |
| DOCX   | Docling | ‚úì | ‚úì |
| MD     | Docling | ‚úì | ‚úì |
| TXT    | Docling | ‚Äî | ‚Äî |

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Docling OCR. Vision LLM (GPT-4V) ‚Äî —ç—Ç–∞–ø 2.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–§–∞–π–ª ‚Üí Parser (Docling) ‚Üí Chunks ‚Üí Embedder (Sentence Transformers) ‚Üí FileStorage
                                                                           ‚Üì
–ó–∞–ø—Ä–æ—Å ‚Üí Embedder ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ cosine search ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**

```
docling-rag/
‚îú‚îÄ‚îÄ cli/
‚îÇ   ‚îú‚îÄ‚îÄ commands.py         # Click: init, add, search, list
‚îÇ   ‚îî‚îÄ‚îÄ config_loader.py    # –ó–∞–≥—Ä—É–∑–∫–∞ config.yaml + –¥–µ—Ñ–æ–ª—Ç—ã
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ parser.py           # Docling: PDF/DOCX/MD/TXT ‚Üí —ç–ª–µ–º–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ chunker.py          # –ù–∞—Ä–µ–∑–∫–∞ –Ω–∞ chunks —Å overlap
‚îÇ   ‚îú‚îÄ‚îÄ embedder.py         # SentenceTransformer ‚Üí L2-–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ storage.py          # Protocol-–∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îî‚îÄ‚îÄ file_storage.py     # NumPy (.npy) + JSON —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ embeddings.npy      # –ú–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (N √ó 384)
‚îÇ   ‚îî‚îÄ‚îÄ metadata.json       # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ chunks
‚îú‚îÄ‚îÄ tests/                  # 45 unit-—Ç–µ—Å—Ç–æ–≤ + 1 integration
‚îú‚îÄ‚îÄ config.yaml
‚îî‚îÄ‚îÄ pyproject.toml
```

**–•—Ä–∞–Ω–∏–ª–∏—â–µ** ‚Äî –¥–≤–∞ —Ñ–∞–π–ª–∞: `embeddings.npy` (–º–∞—Ç—Ä–∏—Ü–∞ N√ó384, float32) + `metadata.json` (—Å–ø–∏—Å–æ–∫ chunk-–º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö). –ó–∞–ø–∏—Å–∏ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ ‚Äî `os.replace()` –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª.

**Protocol-–∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è** `core/storage.py` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å NumPy-—Ñ–∞–π–ª—ã –Ω–∞ pgvector –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ –∫–æ–¥–∞ (—ç—Ç–∞–ø 2).

---

## –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| P0 | `init`, `add`, `search`, `list` | ‚úÖ MVP |
| P0 | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PDF, DOCX, MD, TXT | ‚úÖ MVP |
| P0 | NumPy cosine search | ‚úÖ MVP |
| P1 | `update <file>` ‚Äî –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ñ–∞–π–ª–∞ | üîú |
| P1 | pgvector —Ö—Ä–∞–Ω–∏–ª–∏—â–µ | üîú |
| P2 | LLM-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ (GPT-4, Claude) | üí° |
| P2 | Vision LLM –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–¥–∏–∞–≥—Ä–∞–º–º | üí° |
| P2 | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å | üí° |

---

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å dev-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
uv pip install -e ".[dev]"

# –í—Å–µ –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/ -m "not integration and not slow"

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç (—Ä–µ–∞–ª—å–Ω—ã–π Docling + –º–æ–¥–µ–ª—å, ~10 —Å–µ–∫)
pytest tests/test_integration.py -v -m integration -s

# –¢–æ–ª—å–∫–æ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏)
pytest tests/ -m slow
```

**–¢–µ—Å—Ç—ã:** 45 unit-—Ç–µ—Å—Ç–æ–≤ + 1 integration test. –ú–∞—Ä–∫–µ—Ä `@pytest.mark.integration` –∏—Å–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –∏–∑ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.
